name: Deploy Nebari website

on:
  workflow_dispatch:
  schedule:
    - cron: "37 10 * * *"  # 10:37 UTC daily

jobs:
  build_site:
    runs-on: ubuntu-latest
    environment: docs-prod
    steps:
      - name: Check out repository üõéÔ∏è
        uses: actions/checkout@v4

      - name: Trigger Netlify build üöÄ
        env:
          NETLIFY_WEBHOOK: ${{ secrets.NETLIFY_WEBHOOK }}
        run: |
          # Extra safety: mask the value in logs even if it somehow appears
          echo "::add-mask::$NETLIFY_WEBHOOK"

          # Hit the hook without printing URL or body; fail on HTTP errors
          curl -fsS -X POST "$NETLIFY_WEBHOOK" -o /dev/null
